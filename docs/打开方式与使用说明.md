# ROX Quant 3.0 打开方式与使用说明

## 一、打开方式（推荐）

### 方式一：脚本启动（推荐）

在项目根目录执行：

```bash
./start_server.sh
```

- 会自动使用项目内 `.venv` 的 Python（若存在），否则使用系统 `python3`。
- 自动释放并占用 **8081** 端口。
- 启动后在浏览器打开：
  - **经典版（1.0 风格）**：<http://127.0.0.1:8081/>
  - **专业版（3.0 紧凑三栏）**：<http://127.0.0.1:8081/pro>
- 健康检查：<http://127.0.0.1:8081/api/system/health>
- 按 **Ctrl+C** 停止服务。

### 方式二：直接 uvicorn

```bash
cd /path/to/rox3.0
.venv/bin/python -m uvicorn app.main:app --host 127.0.0.1 --port 8081 --reload
```

然后浏览器访问 <http://127.0.0.1:8081/> 或 <http://127.0.0.1:8081/pro>。

### 方式三：指定端口

若 8081 被占用，可修改 `start_server.sh` 中的 `PORT=8081` 为其他端口（如 8082），或直接：

```bash
.venv/bin/python -m uvicorn app.main:app --host 127.0.0.1 --port 8082
```

访问 <http://127.0.0.1:8082/>。

---

## 二、首次使用建议

1. **环境**：若未发现 `.env`，可复制 `.env.example` 并配置（如 `AI_API_KEY`、`AI_BASE_URL`）以启用 AI 对话与诊断总结。
2. **个股诊断**：行情列表不可用时，可直接输入 **6 位股票代码**（如 600519）获取单股数据与诊断。
3. **社区跟单**：当前为 **示例数据**，非真实用户动态；真实社区需后续扩展用户与发帖存储。

---

## 三、主要入口一览

| 入口           | 地址                         | 说明                     |
|----------------|------------------------------|--------------------------|
| 经典版首页     | http://127.0.0.1:8081/        | 市场/宏观/诊断/知识库/交易/社区/系统 |
| 专业版         | http://127.0.0.1:8081/pro     | 三栏紧凑布局、图表与策略  |
| API 文档(开发) | http://127.0.0.1:8081/docs    | 开发环境下可见           |
| 健康检查       | http://127.0.0.1:8081/api/system/health | 服务与依赖状态   |

---

## 四、功能与数据来源简要说明

- **行情 / 个股**：AkShare（东方财富、新浪等）、静态兜底 `app/static/stock_list.csv`；行情不可用时支持按代码单股拉取。
- **宏观 / 北向 / 资金流**：AkShare 或东方财富接口。
- **个股诊断**：`/api/stock/diagnose` 使用 K 线、基本面、资金流计算；`/api/market/diagnose` 为旧版随机示例，前端诊断结论以 `/api/stock/diagnose` 为准。
- **知识库**：本地文档 + 可选联网搜索（DuckDuckGo）。
- **交易**：本地 SQLite 记录，可切换模拟/实盘（实盘需对接券商）。
- **社区跟单**：当前为示例数据，标注「示例」；非累赘，占位展示，后续可扩展为真实社区。

更细的功能与数据获取检查见：`docs/功能与数据获取检查报告.md`。

---

## 五、故障排除

### 1. 无法访问 / ERR_CONNECTION_TIMED_OUT

- **必须带端口**：地址要写成 **http://127.0.0.1:8081**，不能只写 http://127.0.0.1（后者会连 80 端口，会超时）。
- **先启动服务**：在项目根目录执行 `./start_server.sh`，等终端出现 “Uvicorn running on http://127.0.0.1:8081” 后再用浏览器打开上述地址。
- **检查端口**：若 8081 被占用，可修改 `start_server.sh` 里的 `PORT=8081` 为其他端口（如 8082），或直接运行：
  ```bash
  .venv/bin/python -m uvicorn app.main:app --host 127.0.0.1 --port 8082
  ```
  然后访问 http://127.0.0.1:8082 。

### 2. 启动报错 ModuleNotFoundError

- 若缺少 `duckduckgo_search`：知识库联网搜索会不可用，但**不影响服务启动**；需要联网搜索时可执行：
  ```bash
  .venv/bin/pip install duckduckgo-search
  ```
- 若缺少其他依赖，在项目根目录执行：
  ```bash
  .venv/bin/pip install -r requirements.txt
  ```

### 3. 代理 / 防火墙

- 若本机开了代理，可尝试在浏览器中关闭代理再访问 http://127.0.0.1:8081 ，或确认代理不会拦截 127.0.0.1。
- 本机防火墙若拦截了 8081 端口，需放行后再访问。
