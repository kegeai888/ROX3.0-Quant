# Rox Quant 升级与功能建议（对标通达信等专业终端）

## 一、通达信终端功能概览（参考）

从 **通达信金融终端** 应用结构可见其模块划分完整，Rox 可对标并做差异化增强：

| 通达信模块 | 功能含义 | Rox 现状 | 建议方向 |
|-----------|----------|----------|----------|
| **行情** | 上海A股、深圳、板块、指数等 | 有涨跌排行、K线、自选股 | 补齐分时、多周期、板块指数、沪深列表 |
| **交易** | 登录交易、委托/成交/持仓 | 有模拟交易、交易面板 | 实盘对接、多券商、条件单 |
| **系统** | 系统设置、经典黑/圣洁白主题 | 有 config、深色主题 | 主题切换、数据路径、快捷键配置 |
| **数据工具** | 自选股/用户公式 备份与恢复 | 自选在 DB，无公式备份 | 自选导出/导入、策略/公式备份 |
| **消息中心** | 公告、研报、提醒 | 无 | 消息中心、研报推送、提醒 |
| **自选股同步** | 多端/多设备同步 | 无 | 云端自选同步、多设备 |
| **键盘精灵** | 输入代码/拼音秒切股票 | 有键盘指挥官但未完全打通 | 全局快捷键、F1/F2/F10 |

---

## 二、Rox 可做的升级与新增功能（按优先级）

### 1. 交互与效率（高优先级，文档已多次建议）

| 功能 | 说明 | 实现要点 |
|------|------|----------|
| **键盘精灵** | 输入数字/拼音弹出搜索，Enter 切股，Up/Down 选择 | 全局 keydown 监听，防与输入框冲突；调用现有 `/api/market/fetch-realtime` 或股票搜索 API |
| **F 键系列** | F1 分时 / F2 K线 / F10 资料（或 AI 研报） | 当前页根据 focus 股票切换视图；F10 打开「个股资料」或「AI F10」面板 |
| **紧凑模式** | 减少留白，提高一屏信息量（对标通达信高密度） | 可选 CSS 类或设置项：表格行高、padding、字体略缩小 |
| **价格变动闪烁** | 涨闪红、跌闪绿，持续约 300ms | 列表/盘口单元格加 `data-last-price`，定时比对后加 flash 类动画 |

这些不依赖新数据源，主要在前端和配置层即可完成，**性价比最高**。

---

### 2. 数据与行情（补齐“行情”模块）

| 功能 | 说明 | 实现要点 |
|------|------|----------|
| **分时图** | 当日分时线 + 均线 + 成交量 | 需分时数据接口（如 akshare 或现有数据源）；ECharts 增加分时 option 模板 |
| **多周期 K 线** | 1/5/15/30/60 分钟、日/周/月 | 部分已有；统一 period 参数与前端周期切换 |
| **板块指数与板块成分** | 行业/概念板块列表 + 成分股 | 用 akshare 板块接口；左侧或新 Tab「板块」列表 + 点击看成分股 |
| **沪深 A 股列表** | 全市场股票列表，支持滚动/分页 | 用 akshare 全市场或排行榜接口；虚拟滚动或分页加载 |
| **Level2 盘口** | 五档/十档、逐笔（若有数据） | 当前为静态模拟；有 Level2 源后可接真实推送或轮询 |

目标：在「行情」维度接近通达信的信息广度，同时保留 Rox 的 Web 化与可扩展性。

---

### 3. 资金与指标（专业交易者刚需）

| 功能 | 说明 | 实现要点 |
|------|------|----------|
| **主力资金 / DDE 风格** | 大单净流入、主力净额、资金流向曲线 | 用现有或新增 `hf_indicator` / 资金类接口；副图或独立「资金」Tab |
| **资金流向副图** | 日/周级别资金柱状图或面积图 | 与 K 线同屏副图；数据与 K 线对齐 |
| **更多技术指标** | MACD、KDJ、RSI、BOLL、VOL 等 | 后端或前端计算；ECharts 多 overlay/副图配置 |
| **指标参数可调** | 均线周期、MACD 参数等 | 设置面板 + 存 localStorage 或用户配置 |

与现有「分析」模块（如 主力/暗盘 等）结合，形成「指标 + 资金 + 信号」一体。

---

### 4. AI 与研报（差异化，发挥 Rox 优势）

| 功能 | 说明 | 实现要点 |
|------|------|----------|
| **AI F10** | 按 F10 或按钮打开「个股资料」：LLM 总结财报、公告、研报 | 新面板；调用现有或新 LLM 接口；可缓存按股票+日期 |
| **研报/公告摘要** | 列表 + 点击摘要/全文 | 数据源：东方财富、同花顺等；入库或缓存后供检索与展示 |
| **消息中心** | 公告、研报、自选异动、系统通知 | 类似通达信「消息中心」；站内列表 + 未读标记 + 可选推送 |
| **智能提醒** | 价格、涨跌幅、资金异动等条件提醒 | 规则引擎 + 定时或实时检查；浏览器通知或应用内红点 |

用「AI + 消息」做通达信没有的深度与自动化，而不是简单模仿其静态 F10。

---

### 5. 交易与风控（补齐“交易”模块）

| 功能 | 说明 | 实现要点 |
|------|------|----------|
| **实盘券商对接** | 支持 1～2 家券商委托接口（如华泰、中信等） | 合规前提下对接券商 API；委托/撤单/查询成交与持仓 |
| **条件单** | 价格、时间、拐点等条件触发下单 | 服务端条件引擎 + 与模拟/实盘共用下单通道 |
| **风险控制面板** | 单笔上限、日亏损上限、仓位上限等 | 配置页 + 下单前校验；可做简单风控报表 |
| **交易流水导出** | 导出成交、持仓、资金变动 | 现有交易记录表导出 CSV/Excel |

在现有模拟交易与交易面板基础上，向「可实盘、可风控、可留痕」升级。

---

### 6. 系统与扩展（对标“系统”+“数据工具”）

| 功能 | 说明 | 实现要点 |
|------|------|----------|
| **主题切换** | 经典黑 / 圣洁白 / 当前深蓝灰 | CSS 变量或 Tailwind 主题；存用户偏好 |
| **自选股备份与恢复** | 导出/导入自选列表（文件或云端） | 导出 JSON/CSV；导入时合并或覆盖；可选与账号绑定 |
| **策略/公式备份** | 用户自定义指标、策略的导出与恢复 | 若支持「自定义公式」或 Python 片段，则对应存储与导入 |
| **系统设置** | 数据路径、缓存清理、行情刷新间隔等 | 设置页 + 写 config 或 DB；桌面版可写本地路径 |
| **快捷键配置** | 自定义全局快捷键 | 设置页绑定 key → 动作；与键盘精灵统一存储 |

提升「可配置、可迁移、可多端一致」体验。

---

### 7. 自定义公式与策略（差异化）

| 功能 | 说明 | 实现要点 |
|------|------|----------|
| **Python 指标沙箱** | 用户写简单 Python 片段，计算自定义指标并画在图上 | 安全沙箱（如 restricted 执行）；仅开放行情/指标 API；前端展示为 overlay 或副图 |
| **公式语言** | 通达信风格公式语言解析与执行（可选） | 工作量大；可先做少量内置函数 + 简单解析，或仅做 Python 沙箱 |
| **策略模板与分享** | 内置策略参数化 + 导入/导出/分享 | 策略 JSON 描述；社区或本地文件分享 |

用「可编程」与「AI」区分传统终端，而不是完全复刻通达信公式系统。

---

### 8. 多端与同步（对标“自选股同步”）

| 功能 | 说明 | 实现要点 |
|------|------|----------|
| **自选股云端同步** | 账号下自选多端一致 | 自选表与 user_id 绑定；多端拉取/合并策略 |
| **PWA / 移动端** | 安装到桌面、移动端浏览器体验优化 | PWA manifest + Service Worker；响应式布局已有，可加强触摸与性能 |
| **桌面端快捷键** | 应用级快捷键（如 macOS） | 如 Electron/pywebview 注册全局快捷键，映射到 F1/F2/键盘精灵等 |

---

## 三、建议实施顺序（与现有优化报告一致）

1. **Phase 1（基础体验）**  
   键盘精灵、F1/F2/F10、紧凑模式、价格闪烁。  
   → 先让「用键盘、看行情」的体验接近通达信。

2. **Phase 2（数据与资金）**  
   分时图、主力/资金流向副图、板块与沪深列表、更多技术指标。  
   → 补齐行情与指标，满足「看盘」需求。

3. **Phase 3（AI 与研报）**  
   AI F10、研报/公告摘要、消息中心、简单提醒。  
   → 突出 Rox 的「更聪明、更省时间」。

4. **Phase 4（交易与系统）**  
   实盘对接（若合规）、条件单、风控、自选/策略备份、主题与设置。  
   → 让 Rox 从「看+模拟」走向「可实盘、可配置、可迁移」。

5. **Phase 5（扩展）**  
   Python 指标沙箱、策略模板、自选云端同步、PWA/移动端。  
   → 形成长期差异化与粘性。

---

## 四、总结

- **通达信** 的完整度体现在：行情全、交易闭环、系统设置、数据工具、消息、自选同步、键盘与主题等「成体系」的模块。
- **Rox** 不必在「行情刷新速度」和「安装包体积」上硬拼原生 C++，更适合在以下方面升级：
  - **交互**：键盘精灵 + F 键 + 紧凑布局 + 价格闪烁；
  - **数据**：分时、多周期、板块、沪深列表、资金与指标；
  - **AI**：AI F10、研报摘要、消息中心、提醒；
  - **交易**：实盘对接、条件单、风控、流水导出；
  - **系统**：主题、自选/策略备份、设置、快捷键；
  - **扩展**：Python 沙箱、自选同步、PWA。

按上述阶段推进，Rox 可以在「专业终端」的完整度上逐步对齐通达信，同时在「AI 与可编程」上做出自己的特色。
