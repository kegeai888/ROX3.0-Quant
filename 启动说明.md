# ROX Quant 3.0 启动说明

## 快速启动

在项目根目录执行：

```bash
./start_app.sh
```

## 访问地址

启动成功后，可通过以下地址访问：

- **经典版**: http://0.0.0.0:7860
- **专业版**: http://0.0.0.0:7860/pro
- **健康检查**: http://0.0.0.0:7860/health

### 外网访问

将 `0.0.0.0` 替换为服务器的公网 IP 或域名：

- http://your-server-ip:7860
- http://your-domain.com:7860

## 环境要求

- **Python**: 3.12
- **Conda**: 已安装 Miniconda 或 Anaconda
- **虚拟环境**: py312（脚本会自动创建）

## 启动脚本功能

`start_app.sh` 会自动完成以下操作：

1. ✓ 检查并激活 py312 conda 环境
2. ✓ 自动安装项目依赖（如未安装）
3. ✓ 检测 7860 端口占用情况
4. ✓ 优雅终止占用端口的进程（SIGTERM → SIGKILL）
5. ✓ 等待 2 秒确保端口释放
6. ✓ 设置环境变量（HOST=0.0.0.0, PORT=7860）
7. ✓ 启动 FastAPI 应用

## 配置文件

项目配置位于 `.env` 文件：

```bash
# 服务器配置
DESKTOP_HOST=0.0.0.0    # 监听所有网卡（支持外网访问）
DESKTOP_PORT=7860        # 服务端口
ENVIRONMENT=production   # 运行环境

# 其他配置...
```

## 停止服务

在终端按 `Ctrl+C` 即可停止服务。

## 常见问题

### 1. 端口被占用

脚本会自动处理端口占用问题，无需手动操作。

### 2. 依赖安装失败

手动安装依赖：

```bash
conda activate py312
pip install -r requirements.txt
```

### 3. conda 环境不存在

脚本会自动创建 py312 环境，如需手动创建：

```bash
conda create -n py312 python=3.12 -y
conda activate py312
pip install -r requirements.txt
```

### 4. 外网无法访问

检查防火墙设置，确保 7860 端口已开放：

```bash
# Ubuntu/Debian
sudo ufw allow 7860

# CentOS/RHEL
sudo firewall-cmd --permanent --add-port=7860/tcp
sudo firewall-cmd --reload
```

## 技术架构

- **后端框架**: FastAPI 0.115.5
- **ASGI 服务器**: Uvicorn 0.31.0
- **数据源**: AKShare 1.18.7
- **数据处理**: Pandas 2.3.3, NumPy
- **AI 模型**: Sentence Transformers, OpenAI

## 日志位置

- **应用日志**: `logs/rox_quant.log`
- **数据库**: `data/docs.db`

---

**ROX Quant 3.0** - 量化投研系统
